/*! Sileo Depiction v0.1
 - https://www.yourepo.com/sileo-native-depictions
 - GNU GPL - 3.0 license - Copyright 2019 - YouRepo
 */
!function(e){"use strict";var t=e.jQuery,i=new showdown.Converter;function a(e,i,a,n,v){if(parseFloat(i.minVersion)>0&&"DepictionTabView"==i.class){var f='<div class="SileoDepiction"><div class="SileoDepiction-DepictionTabView" data-minversion="'+i.minVersion+'">';f+='<div class="SileoDepiction-headerImage"',i.headerImage&&(f+=" style=\"background-image:url('"+i.headerImage+"')\""),f+='><div class="SileoDepiction-headerImageShadow"></div></div>',a&&a.length>0&&n&&n.length>0&&v&&v.length>0&&(f+='<div class="SileoDepiction-headerPackage">',f+='<img class="SileoDepiction-sectionImage" src="'+v+'" />',f+='<p class="SileoDepiction-name">'+a+"</p>",f+='<p class="SileoDepiction-author">'+n+"</p>",f+="</div>"),f+='<ul class="SileoDepiction-DepictionTabHeaderView">',i.tabs&&i.tabs.length>0&&t.each(i.tabs,function(e){var t=i.tabs[e];"DepictionStackView"==t.class&&(f+=o(e,t.tabname?t.tabname:"Tab "+(t+1),!1))}),f+='<li class="SileoDepiction-border"></li>',f+='<li class="SileoDepiction-addTab">+</li>',f+="</ul>",f+='<div class="SileoDepiction-DepictionTabContentView">',i.tabs&&i.tabs.length>0&&t.each(i.tabs,function(e){var a=i.tabs[e];f+='<div class="SileoDepiction-DepictionStackView">',a.views&&a.views.length>0&&t.each(a.views,function(t){var i=a.views[t];i&&("DepictionHeaderView"==i.class?f+=l(e,t,!1,i.title):"DepictionImageView"==i.class?f+=r(e,t,i.URL,i.height,i.width,i.horizontalPadding,i.cornerRadius,i.alignment):"DepictionMarkdownView"==i.class?f+=s(e,t,i.useSpacing,i.useRawFormat,i.markdown):"DepictionScreenshotsView"==i.class?f+=p(e,t,i.screenshots,i.itemCornerRadius,i.itemSize):"DepictionSeparatorView"==i.class?f+=c(e,t):"DepictionSpacerView"==i.class?f+=d(e,t,i.spacing):"DepictionSubheaderView"==i.class?f+=h(e,t,!1,i.title,i.useBoldText,i.useBottomMargin):"DepictionTableButtonView"==i.class?f+=u(e,t,!1,i.action,i.title):"DepictionTableTextView"==i.class?f+=S(e,t,!1,i.title,i.text):alert(i.class+" not yet supported."))}),f+='<div class="SileoDepiction-editSileoDepiction"><select><option>Select a view</option><option value="header">Header</option><option value="image">Image</option><option value="markdown">Markdown</option><option value="screenshots">Screenshots</option><option value="separator">Separator</option><option value="spacer">Spacer</option><option value="subheader">Subheader</option><option value="tablebutton">Table button</option><option value="tabletext">Table text</option></select><br /><button class="addSileoDepiction">Add</button></div>',f+="</div>"}),f+="</div>",f+="</div>",f+='<div class="SileoDepiction-DepictionModalView"><div class="SileoDepiction-modal">',f+='<div class="SileoDepiction-modal-header"><h3>Modal</h3><span class="SileoDepiction-closeModal">&times;</span></div>',f+='<div class="SileoDepiction-modal-body"></div></div></div></div>',e.html(f);var b=e.find(".SileoDepiction-DepictionTabHeaderView"),g=b.children().first();g.hasClass("SileoDepiction-tabSwitch")?D(g):m(b)}else alert("Version not supported.")}function n(e){var a="",n=e.find(".SileoDepiction-DepictionTabView").first();if(n&&n.length>0){var o={class:"DepictionTabView",headerImage:n.find(".SileoDepiction-headerImage").css("background-image").replace(")","").replace("url(","").replace(/\"/gi,""),minVersion:parseFloat(n.attr("data-minversion")),tabs:[]};t.each(n.find(".SileoDepiction-DepictionStackView"),function(e){if(!t(this).hasClass(".SileoDepiction-edit")){var a={class:"DepictionStackView",tabname:n.find(".SileoDepiction-tabSwitch:nth-child("+(e+1)+") .SileoDepiction-text").text(),views:[]};t.each(t(this).children(),function(e){if(t(this).hasClass("SileoDepiction-DepictionHeaderView"))a.views.push({class:"DepictionHeaderView",title:t(this).find(".SileoDepiction-text").text()});else if(t(this).hasClass("SileoDepiction-DepictionImageView"))a.views.push({class:"DepictionImageView",alignment:parseInt(t(this).find("img").attr("data-alignment")?t(this).find("img").attr("data-alignment"):0),cornerRadius:parseFloat(t(this).find("img").attr("data-cornerradius")?t(this).find("img").attr("data-cornerradius"):"0"),height:parseFloat((2*t(this).find("img").attr("height")).toFixed(5)),horizontalPadding:parseFloat(t(this).find("img").attr("data-horizontalpadding")?t(this).find("img").attr("data-horizontalpadding"):"0"),URL:t(this).find("img").attr("src"),width:parseFloat((2*t(this).find("img").attr("width")).toFixed(5))});else if(t(this).hasClass("SileoDepiction-DepictionMarkdownView"))a.views.push({class:"DepictionMarkdownView",markdown:i.makeMarkdown(t(this).children().first().html()),useRawFormat:!!t(this).attr("data-userawformat"),useSpacing:!!t(this).attr("data-SileoDepiction-useSpacing")});else if(t(this).hasClass("SileoDepiction-DepictionScreenshotsView")){var n={class:"DepictionScreenshotsView",itemSize:t(this).attr("data-itemsize"),itemCornerRadius:parseFloat(t(this).attr("data-itemcornerradius")?t(this).attr("data-itemcornerradius"):"0"),screenshots:[]};t.each(t(this).find("img"),function(e){t(this).attr("src")&&n.screenshots.push({accessibilityText:t(this).attr("alt")?t(this).attr("alt"):"Screenshot",url:t(this).attr("src")})}),a.views.push(n)}else t(this).hasClass("SileoDepiction-DepictionSeparatorView")?a.views.push({class:"DepictionSeparatorView"}):t(this).hasClass("SileoDepiction-DepictionSpacerView")?a.views.push({class:"DepictionSpacerView",spacing:parseFloat(t(this).attr("data-spacing"))}):t(this).hasClass("SileoDepiction-DepictionSubheaderView")?a.views.push({class:"DepictionSubheaderView",useBoldText:!!t(this).find("p").hasClass("SileoDepiction-useBoldText"),useBottomMargin:!!t(this).find("p").hasClass("SileoDepiction-useBottomMargin"),title:t(this).find("p").text()}):t(this).hasClass("SileoDepiction-DepictionTableButtonView")?a.views.push({class:"DepictionTableButtonView",action:t(this).find("a").attr("href"),title:t(this).find(".SileoDepiction-text").text()}):t(this).hasClass("SileoDepiction-DepictionTableTextView")?a.views.push({class:"DepictionTableTextView",text:t(this).find(".SileoDepiction-text").text(),title:t(this).find(".SileoDepiction-title").text()}):t(this).hasClass("SileoDepiction-editSileoDepiction")||alert(t(this).attr("class")+" not yet supported.")}),o.tabs.push(a)}});try{a=JSON.stringify(o)}catch(e){alert("Impossible to stringify the value."),console.log(e)}}else alert("No depiction found.");return a}function o(e,t,i){return'<li data-tab="'+e+'" class="SileoDepiction-tabSwitch"><div class="SileoDepiction-text contenteditable"'+(i?' contenteditable="true"':"")+">"+(t&&t.length>0?t:"Tab "+(e+1))+'</div><span class="SileoDepiction-removeTab">&times;</span></li>'}function l(e,t,i,a){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Header" class="SileoDepiction-DepictionHeaderView"><div class="SileoDepiction-text contenteditable"'+(i?' contenteditable="true"':"")+">"+(a&&a.length>0?a:"No title")+'</div><span class="SileoDepiction-removeView">&times;</span></div>'}function r(e,t,i,a,n,o,l,r){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Image" class="SileoDepiction-DepictionImageView"'+(r?' style="text-align:'+(1==r?'center;"':'right;"'):"")+'><img src="'+(i&&i.length>0?i:"")+'" height="'+(a>0?.5*a:"")+'" width="'+(n>0?.5*n:"")+'" style="'+(a>0?"height:"+.5*a+"px;":"")+(n>0?"width:"+.5*n+"px;":"")+(o?"padding: 0 "+.5*o+"px;":"")+(l?"border-radius:"+l+"px;":"")+(r?"text-align:"+(1==r?"center;":"right;")+'" data-alignment="'+r:"")+(o?'" data-horizontalpadding="'+o:"")+(l?'" data-cornerradius="'+l:"")+'" alt="Image" /><span class="SileoDepiction-removeView">&times;</span><span class="SileoDepiction-wrenchView">Edit</span></div>'}function s(e,t,a,n,o){return n?(i.setOption("rawHeaderId",!0),i.setOption("rawPrefixHeaderId",!0)):(i.setOption("rawHeaderId",!1),i.setOption("rawPrefixHeaderId",!1)),'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Markdown" class="SileoDepiction-DepictionMarkdownView"'+(a?' SileoDepiction-useSpacing" data-usespacing="true"':'"')+(n?' data-userawformat="true"':"")+'><div id="SileoDepiction-markdown-'+e+"-"+t+'">'+i.makeHtml((o||"No markdown").replace(/(body|html)/,"#SileoDepiction-markdown-"+e+"-"+t+"{"))+'</div><span class="SileoDepiction-removeView">&times;</span><span class="SileoDepiction-wrenchView">Edit</span></div>'}function p(e,i,a,n,o){var l,r,s=0;if(n?l=n:n=0,o){var p=o.replace("{","").replace("}","").split(",");Array.isArray(p)&&(p[0]>0&&(s=.75*parseFloat(p[0])),p[1]>0&&(r=.75*parseFloat(p[1])))}else o="";var c='<div id="SileoDepiction-'+e+"-"+i+'" data-name="Screenshots" class="SileoDepiction-DepictionScreenshotsView" data-itemcornerradius="'+n+'" data-itemsize="'+o+'">';return c+='<ul style="height:'+r+'px">',a&&a.length>0&&t.each(a,function(e){a[e].url&&(c+='<li style="border-radius:'+l+";height:"+r+"px;width:"+s+'px">',c+='<img src="'+a[e].url+'" alt="',a[e].accessibilityText?c+=a[e].accessibilityText:c+="Screenshot",c+='" style="border-radius:'+l+"px;height:"+r+"px;width:"+s+'px" height="'+r+'" width="'+s+'" />',c+="</li>")}),c+="</ul>",c+='<span class="SileoDepiction-removeView">&times;</span>',c+='<span class="SileoDepiction-wrenchView">Edit</span>',c+="</div>"}function c(e,t){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Separator" class="SileoDepiction-DepictionSeparatorView"><span class="SileoDepiction-removeView">&times;</span></div>'}function d(e,t,i){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Spacer" class="SileoDepiction-DepictionSpacerView"'+(i&&i>0?' style="height:'+.5*i+'px" data-spacing="'+i+'"':' data-spacing="0"')+'><span class="SileoDepiction-removeView">&times;</span><span class="SileoDepiction-wrenchView">Edit</span></div>'}function h(e,t,i,a,n,o){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Subheader" class="SileoDepiction-DepictionSubheaderView"><p class="contenteditable '+(n?" SileoDepiction-useBoldText":"")+(o?" SileoDepiction-useBottomMargin":"")+'"'+(i?' contenteditable="true"':"")+">"+(a&&a.length>0?a:"No title")+'</p><span class="SileoDepiction-removeView">&times;</span><span class="SileoDepiction-wrenchView">Edit</span></div>'}function u(e,t,i,a,n){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Table button" class="SileoDepiction-DepictionTableButtonView"><a target="_blank" '+(a&&a.length>0?' href="'+a+'"':"")+'><div class="SileoDepiction-text contenteditable"'+(i?' contenteditable="true"':"")+">"+(n&&n.length>0?n:"No title")+'</div><span class="SileoDepiction-link">Link</span><span class="SileoDepiction-chevron">›</span></a><span class="SileoDepiction-removeView">&times;</span></div>'}function S(e,t,i,a,n){return'<div id="SileoDepiction-'+e+"-"+t+'" data-name="Table text" class="SileoDepiction-DepictionTableTextView"><div class="SileoDepiction-title contenteditable"'+(i?' contenteditable="true"':"")+">"+(a&&a.length>0?a:"No title")+'</div><div class="SileoDepiction-text contenteditable"'+(i?' contenteditable="true"':"")+">"+(n&&n.length>0?n:"No text")+'</div><span class="SileoDepiction-removeView">&times;</span></div>'}function m(e){var t=e.find(".SileoDepiction-tabSwitch.SileoDepiction-active");t.length?e.find("li.SileoDepiction-border").animate({left:t.get(0).offsetLeft+2+(parseInt(t.attr("data-tab"))+1==1?20:0),width:t.width()+4},"fast"):e.find("li.SileoDepiction-border").animate({width:0},"fast")}function D(e){var t=parseInt(e.attr("data-tab"))+1,i=e.parent();i.find(".SileoDepiction-tabSwitch").removeClass("SileoDepiction-active"),e.addClass("SileoDepiction-active");for(var a=0,n=0;n<t;n++)n<t-1?a+=i.find('.SileoDepiction-tabSwitch[data-tab="'+n+'"]').width()+4:a-=.5*i.width()+10-i.find('.SileoDepiction-tabSwitch[data-tab="'+n+'"]').width();m(i),i.animate({scrollLeft:a},"fast"),i.next().animate({scrollLeft:281.5*(t-1),height:i.next().find(".SileoDepiction-DepictionStackView:nth-child("+t+")").height()+"px"},"fast")}t.fn.SileoDepiction=function(){return{container:t(this),originalJSON:null,originalName:null,originalAuthor:null,originalIcon:null,load:function(e,t,i,n){this.originalJSON=e,this.originalName=t,this.originalAuthor=i,this.originalIcon=n,a(this.container,e,t,i,n)},stringify:function(){return n(this.container)},edit:function(){var e=this.container.find(".SileoDepiction-DepictionTabView").first();e&&e.length>0&&!e.hasClass("SileoDepiction-edit")&&(e.addClass("SileoDepiction-edit"),e.find(".contenteditable").attr("contenteditable",!0),setTimeout(function(){D(e.find(".SileoDepiction-tabSwitch.SileoDepiction-active"))},150))},cancel:function(){var e=this.container.find(".SileoDepiction-DepictionTabView").first();e&&e.length>0&&e.hasClass("SileoDepiction-edit")&&a(this.container,this.originalJSON,this.originalName,this.originalAuthor,this.originalIcon)},save:function(){var e=this.container.find(".SileoDepiction-DepictionTabView").first();e&&e.length>0&&e.hasClass("SileoDepiction-edit")&&(e.removeClass("SileoDepiction-edit"),e.find(".SileoDepiction-tabSwitch .SileoDepiction-text").removeAttr("contenteditable"),e.find(".SileoDepiction-DepictionHeaderView .SileoDepiction-text").removeAttr("contenteditable"));var t=n(this.container);if(t&&""!=t)try{var i=JSON.parse(t);return this.originalJSON=i,t}catch(e){alert("Impossible to parse stringifySileoDepiction"),console.log(e)}return!1}}},t(document).on("click",".addSileoDepiction",function(e){e.preventDefault();var i=t(this).parent(),a=i.parent(),n=a.parent().prev().find(".SileoDepiction-tabSwitch.SileoDepiction-active");switch(t(this).prev().prev().val()){case"header":i.before(l(n.attr("data-tab"),a.children().length-1,!0));break;case"image":i.before(r(n.attr("data-tab"),a.children().length-1));break;case"markdown":i.before(s(n.attr("data-tab"),a.children().length-1));break;case"screenshots":i.before(p(n.attr("data-tab"),a.children().length-1));break;case"separator":i.before(c(n.attr("data-tab"),a.children().length-1));break;case"spacer":i.before(d(n.attr("data-tab"),a.children().length-1,10));break;case"subheader":i.before(h(n.attr("data-tab"),a.children().length-1,!0));break;case"tablebutton":i.before(u(n.attr("data-tab"),a.children().length-1,!0));break;case"tabletext":i.before(S(n.attr("data-tab"),a.children().length-1,!0));break;default:alert("Please select a view.")}D(n)}),t(document).on("click",".SileoDepiction-edit .SileoDepiction-DepictionTableButtonView a",function(e){e.preventDefault()}),t(document).on("click",".SileoDepiction-edit .SileoDepiction-DepictionTableButtonView a .SileoDepiction-link",function(i){i.preventDefault();var a=e.prompt("What URL do you want to use?",t(this).parent().attr("href"));a&&t(this).parent().attr("href",a)}),t(document).on("click",".SileoDepiction-DepictionTabView .SileoDepiction-tabSwitch",function(e){e.preventDefault();var i=t(this);parseInt(i.attr("data-tab"));i.parent().find(".SileoDepiction-tabSwitch").removeClass("SileoDepiction-active"),i.addClass("SileoDepiction-active"),D(i)}),t(document).on("click",".SileoDepiction-DepictionTabView .SileoDepiction-addTab",function(e){e.preventDefault();var i=t(this).parent().next().find(".SileoDepiction-DepictionStackView").length;t(this).prev().before(o(i,"Tab "+(i+1),!0)),t(this).parent().next().append('<div class="SileoDepiction-DepictionStackView"><div class="SileoDepiction-editSileoDepiction"><select><option>Select a view</option><option value="header">Header</option><option value="image">Image</option><option value="markdown">Markdown</option><option value="screenshots">Screenshots</option><option value="separator">Separator</option><option value="spacer">Spacer</option><option value="subheader">Subheader</option><option value="tablebutton">Table button</option><option value="tabletext">Table text</option></select><br /><button class="addSileoDepiction">Add</button></div></div>'),t(this).parent().find(".SileoDepiction-tabSwitch").removeClass("SileoDepiction-active");var a=t(this).parent().find(".SileoDepiction-tabSwitch").last();D(a),a.find(".SileoDepiction-text").focus()}),t(document).on("click",".SileoDepiction-DepictionTabView .SileoDepiction-removeTab",function(i){if(i.preventDefault(),i.stopPropagation(),e.confirm("Are you sure you want to delete this tab and all views?")){var a=t(this).parent(),n=t(this).parent().prev(),o=t(this).parent().next(),l=t(this).parent().hasClass("SileoDepiction-active"),r=parseInt(a.attr("data-tab"))+1,s=a.parent(),p=s.next(),c=p.find(".SileoDepiction-DepictionStackView").length;a.fadeOut("fast",function(){t(this).remove()}),p.find(".SileoDepiction-DepictionStackView:nth-child("+r+")").fadeOut("fast",function(){if(t(this).remove(),c>1&&r<=c){var e=0;for(e=r;e<c;e++)s.find('.SileoDepiction-tabSwitch[data-tab="'+e+'"]').attr("data-tab",e-1);l&&1==r?o.addClass("SileoDepiction-active"):l&&n.addClass("SileoDepiction-active"),D(s.find(".SileoDepiction-tabSwitch.SileoDepiction-active"))}else m(s)})}}),t(document).on("keydown keyup",".SileoDepiction-DepictionTabView .SileoDepiction-tabSwitch .SileoDepiction-text",function(e){m(t(this).parent().parent())}),t(document).on("click",".SileoDepiction-DepictionTabContentView .SileoDepiction-wrenchView",function(e){e.preventDefault(),e.stopPropagation();var a=t(this).parent(),n=t(this).parent().parent().parent().parent().parent().find(".SileoDepiction-DepictionModalView");n.attr("data-view",a.attr("id")),n.attr("data-type",a.attr("class")),n.addClass("SileoDepiction-visible");var o=n.find("h3"),l=n.find(".SileoDepiction-modal-body");if(a.hasClass("SileoDepiction-DepictionImageView")){o.text(a.attr("data-name")),l.html('<p class="SileoDepiction-text-center"><label for="URL">Image URL</label></p>'),(r=t("<p>").appendTo(l)).html(t("<input>").attr({type:"text",placeholder:"Image URL",value:a.find("img").attr("src"),name:"URL",id:"URL"})),l.append('<p class="SileoDepiction-text-center"><label for="height">Height</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Height",value:(2*parseFloat(a.find("img").attr("height")?a.find("img").attr("height"):"0")).toFixed(5),name:"height",id:"height"})),l.append('<p class="SileoDepiction-text-center"><label for="width">Width</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Width",value:(2*parseFloat(a.find("img").attr("width")?a.find("img").attr("width"):"0")).toFixed(5),name:"width",id:"width"})),l.append('<p class="SileoDepiction-text-center"><label for="alignment">Alignment</label></p>');var r=t("<p>").appendTo(l),s=t("<select>").attr({id:"alignment",name:"alignment"}).appendTo(r),p=parseInt(a.find("img").attr("data-alignment")?a.find("img").attr("data-alignment"):0),c=t("<option>").attr("value","0").text("Left");s.append(c);var d=t("<option>").attr("value","1").text("Center");1==p&&d.attr("selected","selected"),s.append(d);var h=t("<option>").attr("value","2").text("Right");2==p&&h.attr("selected","selected"),s.append(h),l.append('<p class="SileoDepiction-text-center"><label for="cornerRadius">Corner radius</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Corner radius",value:parseFloat(a.find("img").attr("data-cornerradius")?a.find("img").attr("data-cornerradius"):"0"),name:"cornerRadius",id:"cornerRadius"})),l.append('<p class="SileoDepiction-text-center"><label for="horizontalPadding">Horizontal padding</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Horizontal padding",value:parseFloat(a.find("img").attr("data-horizontalpadding")?a.find("img").attr("data-horizontalpadding"):"0"),name:"horizontalPadding",id:"horizontalPadding"})),l.append('<p><button class="saveModal">Save</button></p>')}else if(a.hasClass("SileoDepiction-DepictionMarkdownView")){o.text(a.attr("data-name")),l.html('<p><textarea placeholder="Markdown">'+i.makeMarkdown(a.children().first().html())+"</textarea></p>");var u=t("<input>").attr({type:"checkbox",name:"useRawFormat",id:"useRawFormat"});a.attr("data-userawformat")&&u.attr("checked","checked"),(r=t("<p>").appendTo(l)).html('<label for="useRawFormat">Use raw format : </label>'),r.append(u);var S=t("<input>").attr({type:"checkbox",name:"useSpacing",id:"useSpacing"});a.attr("data-usespacing")&&S.attr("checked","checked"),(r=t("<p>").appendTo(l)).html('<label for="useSpacing">Use spacing : </label>'),r.append(S),l.append('<p><button class="saveModal">Save</button></p>')}else if(a.hasClass("SileoDepiction-DepictionScreenshotsView")){var m,D=0;if(a.attr("data-itemsize")){var v=a.attr("data-itemsize").replace("{","").replace("}","").split(",");Array.isArray(v)&&(v[0]>0&&(m=parseFloat(v[0])),v[1]>0&&(D=parseFloat(v[1])))}o.text(a.attr("data-name")),l.html('<p class="SileoDepiction-text-center"><label for="itemCornerRadius">Corner radius</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Corner radius",value:parseFloat(a.attr("data-itemcornerradius")?a.attr("data-itemcornerradius"):"0"),name:"itemCornerRadius",id:"itemCornerRadius"})),l.append('<p class="SileoDepiction-text-center"><label for="height">Height</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Height",value:D,name:"height",id:"height"})),l.append('<p class="SileoDepiction-text-center"><label for="width">Width</label></p>'),(r=t("<p>").appendTo(l)).append(t("<input>").attr({type:"number",step:"0.01",placeholder:"Width",value:m,name:"width",id:"width"})),l.append("<hr />"),t.each(a.find("img"),function(e){var i=t('<div data-screen="'+(e+1)+'">').appendTo(l);i.html('<p class="SileoDepiction-text-center">Screenshot '+(e+1)+'<span class="SileoDepiction-removeScreenshot">&times;</span></p>'),i.append('<p class="SileoDepiction-text-center"><label for="URL['+(e+1)+']">Image URL</label></p>'),t("<p>").appendTo(i).html(t("<input>").attr({type:"text",placeholder:"Image URL",value:t(this).attr("src")?t(this).attr("src"):"",name:"URL[]",id:"URL["+(e+1)+"]"})),i.append('<p class="SileoDepiction-text-center"><label for="accessibilityText['+(e+1)+']">Accessibility text</label></p>'),t("<p>").appendTo(i).html(t("<input>").attr({type:"text",placeholder:"Accessibility text",value:t(this).attr("alt")?t(this).attr("alt"):"",name:"accessibilityText[]",id:"accessibilityText["+(e+1)+"]"})),i.append("<hr />")}),l.append('<p><button class="addMoreScreenshot">Add another screenshot</button></p>'),l.append('<p><button class="saveModal">Save</button></p>')}else if(a.hasClass("SileoDepiction-DepictionSpacerView")){o.text(a.attr("data-name")),l.html('<p class="SileoDepiction-text-center"><label for="spacing">Spacing :</label></p>'),(r=t("<p>").appendTo(l)).html(t("<input>").attr({type:"number",step:"0.01",placeholder:"Spacing",value:a.attr("data-spacing"),name:"spacing",id:"spacing"})),l.append('<p><button class="saveModal">Save</button></p>')}else if(a.hasClass("SileoDepiction-DepictionSubheaderView")){o.text(a.attr("data-name")),l.html('<p class="SileoDepiction-text-center"><label for="title">Title :</label></p>'),(r=t("<p>").appendTo(l)).html(t("<input>").attr({type:"text",placeholder:"Title",value:a.children().first().text(),name:"title",id:"title"}));var f=t("<input>").attr({type:"checkbox",name:"useBoldText",id:"useBoldText"});a.children().first().hasClass("SileoDepiction-useBoldText")&&f.attr("checked","checked"),(r=t("<p>").appendTo(l)).html('<label for="useBoldText">Use bold text : </label>'),r.append(f);var b=t("<input>").attr({type:"checkbox",name:"useBottomMargin",id:"useBottomMargin"});a.children().first().hasClass("SileoDepiction-useBottomMargin")&&b.attr("checked","checked"),(r=t("<p>").appendTo(l)).html('<label for="useBottomMargin">Use bottom margin : </label>'),r.append(b),l.append('<p><button class="saveModal">Save</button></p>')}else o.text("Modal"),l.html("<p>In progress...</p>"),alert(a.attr("class")+" is not yet supported.")}),t(document).on("click",".addMoreScreenshot",function(e){e.preventDefault();var i=t(this).parent().parent().find('input[name="URL[]"]').length+1,a=t('<div data-screen="'+i+'">');t(this).parent().before(a),a.html('<p class="SileoDepiction-text-center">Screenshot '+i+'<span class="SileoDepiction-removeScreenshot" data-screen="'+i+'">&times;</span></p>'),a.append('<p class="SileoDepiction-text-center"><label for="URL['+i+']">Image URL</label></p>'),t("<p>").appendTo(a).html(t("<input>").attr({type:"text",placeholder:"Image URL",value:"",name:"URL[]",id:"URL["+i+"]"})),a.append('<p class="SileoDepiction-text-center"><label for="accessibilityText['+i+']">Accessibility text</label></p>'),t("<p>").appendTo(a).html(t("<input>").attr({type:"text",placeholder:"Accessibility text",value:"",name:"accessibilityText[]",id:"accessibilityText["+i+"]"})),a.append("<hr />")}),t(document).on("click",".saveModal",function(e){e.preventDefault();var a=t(this).parent().parent().parent().parent(),n=t("#"+a.attr("data-view")),o=a.attr("data-type");if(n&&o)if("SileoDepiction-DepictionImageView"==o){var l="",r=a.find('select[name="alignment"] option:selected').val();r?(n.find("img").attr("data-alignment",r),1==r?n.attr("style","text-align:center"):n.attr("style","text-align:right")):(n.find("img").attr("data-alignment","0"),n.attr("style","text-align:left")),(d=a.find('input[name="cornerRadius"]').val())?(n.find("img").attr("data-cornerradius",d),l+="border-radius:"+d+"px;"):n.find("img").attr("data-cornerradius","0");var s=a.find('input[name="horizontalPadding"]').val();s?(n.find("img").attr("data-horizontalpadding",s),l+="padding:0 "+.5*s+"px;"):(n.find("img").attr("data-horizontalpadding","0"),l+="padding:0;"),(h=a.find('input[name="height"]').val())?(n.find("img").attr("height",.5*h),l+="height:"+.5*h+"px;"):n.find("img").attr("height",0),(c=a.find('input[name="width"]').val())?(n.find("img").attr("width",.5*c),l+="width:"+.5*c+"px;"):n.find("img").attr("width",0);var p=a.find('input[name="URL"]').val();p&&n.find("img").attr("src",p),n.find("img").attr("style",l),a.removeClass("SileoDepiction-visible"),D(a.prev().find(".SileoDepiction-tabSwitch.SileoDepiction-active"))}else if("SileoDepiction-DepictionMarkdownView"==o)a.find('input[name="useRawFormat"]').prop("checked")?(i.setOption("rawHeaderId",!0),i.setOption("rawPrefixHeaderId",!0),n.attr("data-userawformat","true")):(i.setOption("rawHeaderId",!1),i.setOption("rawPrefixHeaderId",!1),n.removeAttr("data-userawformat")),a.find('input[name="useSpacing"]').prop("checked")?(n.attr("data-usespacing","true"),n.attr("style","padding:10px 0")):(n.removeAttr("data-usespacing"),n.removeAttr("style")),n.children().first().html(i.makeHtml(a.find("textarea").val()?a.find("textarea").val():"No markdown")),a.removeClass("SileoDepiction-visible"),D(a.prev().find(".SileoDepiction-tabSwitch.SileoDepiction-active"));else if("SileoDepiction-DepictionScreenshotsView"==o){l="";var c,d,h=a.find('input[name="height"]').val(),u=n.find("ul");!h||parseFloat(h)<=0?h=0:l+="height:"+.75*h+"px;",!(c=a.find('input[name="width"]').val())||parseFloat(c)<=0?c=0:l+="width:"+.75*c+"px;",!(d=a.find('input[name="itemCornerRadius"]').val())||parseFloat(d)<=0?n.attr("data-itemcornerradius","0"):(n.attr("data-itemcornerradius",d),l+="border-radius:"+d+"px;"),n.attr("data-itemsize","{"+c+","+h+"}"),u.html(""),u.attr("style","height:"+.75*h+"px"),t.each(a.find('input[name="URL[]"]'),function(){var e=t("<li>").appendTo(u);e.attr("style",l);var i=t("<img />");i.attr("src",t(this).val()),i.attr("style",l),i.attr("height",h),i.attr("width",c),t(this).parent().next().next().find("input").val()?i.attr("alt",t(this).parent().next().next().find("input").val()):i.attr("alt","Screenshot"),e.html(i)}),a.removeClass("SileoDepiction-visible"),D(a.prev().find(".SileoDepiction-tabSwitch.SileoDepiction-active"))}else if("SileoDepiction-DepictionSpacerView"==o){var S=a.find('input[name="spacing"]').val();S?(n.attr("style","height:"+.5*S+"px"),n.attr("data-spacing",S)):(n.attr("data-spacing","0"),n.removeAttr("style")),a.removeClass("SileoDepiction-visible"),D(a.prev().find(".SileoDepiction-tabSwitch.SileoDepiction-active"))}else"SileoDepiction-DepictionSubheaderView"==o?(n.children().first().text(a.find('input[name="title"]').val()),a.find('input[name="useBoldText"]').prop("checked")?n.children().first().addClass("SileoDepiction-useBoldText"):n.children().first().removeClass("SileoDepiction-useBoldText"),a.find('input[name="useBottomMargin"]').prop("checked")?n.children().first().addClass("SileoDepiction-useBottomMargin"):n.children().first().removeClass("SileoDepiction-useBottomMargin"),a.removeClass("SileoDepiction-visible"),D(a.prev().find(".SileoDepiction-tabSwitch.SileoDepiction-active"))):alert(o+" is not yet supported.");else alert(a.attr("data-view")+" is not a view.")}),t(document).on("click",".SileoDepiction-closeModal",function(e){e.preventDefault(),t(this).parent().parent().parent().removeClass("SileoDepiction-visible")}),t(document).on("click",".SileoDepiction-DepictionTabContentView .SileoDepiction-removeView",function(i){i.preventDefault(),i.stopPropagation();var a=t(this).parent(),n=a.parent().parent().prev();a.addClass("SileoDepiction-blink"),e.confirm("Are you sure you want to delete this view : "+a.attr("data-name")+" ?")?a.fadeOut("fast",function(){t(this).remove(),D(n.find(".SileoDepiction-tabSwitch.SileoDepiction-active"))}):a.removeClass("SileoDepiction-blink")}),t(document).on("click",".SileoDepiction-removeScreenshot",function(e){e.preventDefault();var i=t(this).parent().parent(),a=i.parent(),n=i.attr("data-screen");if(n){i.removeAttr("data-screen");var o=a.find('input[name="URL[]"]').length;i.fadeOut("fast",function(){t(this).remove()});for(;n<o;n++){var l=a.find('label[for="URL['+(parseInt(n)+1)+']"]');l.parent().prev().html("Screenshot "+n+'<span class="SileoDepiction-removeScreenshot">&times;</span>'),l.parent().next().find("input").attr("id","URL["+n+"]"),l.parent().next().next().attr("for","accessibilityText["+n+"]"),l.parent().next().next().next().find("input").attr("id","accessibilityText["+n+"]"),l.parent().parent().attr("data-screen",n),l.attr("for","URL["+n+"]")}}})}(window);
